/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/utils/experiments.py:32: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/cluster/work/sebasrb/zbot-policy-walking/train.py:881: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  num_inputs: int = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:882: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  num_outputs: int = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:883: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  num_mixtures: int = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:884: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  min_std: float = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:885: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  max_std: float = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:886: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  var_scale: float = eqx.static_field()
2025-10-31 17:03:10.210554: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1761926590.226232  143166 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1761926590.231399  143166 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1761926590.245258  143166 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1761926590.245304  143166 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1761926590.245310  143166 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1761926590.245315  143166 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/utils/experiments.py:32: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/cluster/work/sebasrb/zbot-policy-walking/train.py:881: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  num_inputs: int = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:882: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  num_outputs: int = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:883: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  num_mixtures: int = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:884: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  min_std: float = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:885: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  max_std: float = eqx.static_field()
/cluster/work/sebasrb/zbot-policy-walking/train.py:886: UserWarning: `equinox.static_field` is deprecated in favour of `equinox.field(static=True)`
  var_scale: float = eqx.static_field()
2025-10-31 17:03:26.462411: I external/xla/xla/pjrt/pjrt_api.cc:118] GetPjrtApi was found for cuda at /cluster/home/sebasrb/.local/lib/python3.11/site-packages/jax_plugins/xla_cuda12/xla_cuda_plugin.so
2025-10-31 17:03:26.462843: I external/xla/xla/pjrt/pjrt_api.cc:96] PJRT_Api is set for device type cuda
INFO:2025-10-31 17:03:26,466:jax._src.xla_bridge:822: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
2025-10-31 17:03:26.466848: I external/xla/xla/pjrt/pjrt_api.cc:167] The PJRT plugin has PJRT API version 0.75. The framework PJRT API version is 0.75.
2025-10-31 17:03:26.617567: I external/xla/xla/service/service.cc:163] XLA service 0xa4820c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-10-31 17:03:26.617612: I external/xla/xla/service/service.cc:171]   StreamExecutor device (0): NVIDIA H100 80GB HBM3, Compute Capability 9.0
2025-10-31 17:03:26.646905: I external/xla/xla/stream_executor/cuda/cuda_dnn.cc:473] Loaded cuDNN version 91301
2025-10-31 17:03:26.647189: I external/xla/xla/pjrt/pjrt_c_api_client.cc:133] PjRtCApiClient created.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/cluster/work/sebasrb/zbot-policy-walking/train.py", line 1816, in <module>
    ZbotWalkingTask.launch(
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/mixins/runnable.py", line 50, in launch
    launcher.launch(cls, *cfgs, use_cli=use_cli)
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/launchers/cli.py", line 40, in launch
    SingleProcessLauncher().launch(task, *cfgs, use_cli=use_cli_next)
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/launchers/single_process.py", line 31, in launch
    run_single_process_training(task, *cfgs, use_cli=use_cli)
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/launchers/single_process.py", line 21, in run_single_process_training
    task_obj.run()
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/ksim/task/rl.py", line 1026, in run
    self.run_training()
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/ksim/task/rl.py", line 2158, in run_training
    constants, carry, state = self.initialize_rl_training(mj_model, rng)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/ksim/task/rl.py", line 2071, in initialize_rl_training
    models, optimizers, opt_states, state = self.load_initial_state(model_rng, load_optimizer=True)
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/mixins/train.py", line 379, in load_initial_state
    model, state, config = self.load_ckpt(init_ckpt_path, part="model_state_config")
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/mixins/train.py", line 486, in load_ckpt
    model, state, config = load_ckpt(path, part="model_state_config", model_templates=model_specs)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/mixins/checkpointing.py", line 179, in load_ckpt
    return get_model(), get_state(), get_config()
           ^^^^^^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/xax/task/mixins/checkpointing.py", line 134, in get_model
    models.append(eqx.tree_deserialise_leaves(io.BytesIO(model.read()), model_template))
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/equinox/_serialisation.py", line 333, in tree_deserialise_leaves
    jtu.tree_map_with_path(_assert_same(array_impl_type), out, like, is_leaf=is_leaf)
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/jax/_src/tree_util.py", line 1199, in tree_map_with_path
    return treedef.unflatten(f(*xs) for xs in zip(*all_keypath_leaves))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/jax/_src/tree_util.py", line 1199, in <genexpr>
    return treedef.unflatten(f(*xs) for xs in zip(*all_keypath_leaves))
                             ^^^^^^
  File "/cluster/work/sebasrb/zbot-policy-walking/ksim-env/lib/python3.11/site-packages/equinox/_serialisation.py", line 178, in _assert_same_impl
    raise RuntimeError(
RuntimeError: Deserialised leaf at path (GetAttrKey(name='actor'), GetAttrKey(name='input_proj'), GetAttrKey(name='weight')) has changed shape from (128, 42) in `like` to (128, 50) on disk.
2025-10-31 17:05:16.521850: I external/xla/xla/stream_executor/cuda/subprocess_compilation.cc:349] ptxas warning : Registers are spilled to local memory in function 'input_transpose_fusion_43', 8 bytes spill stores, 4 bytes spill loads
ptxas warning : Registers are spilled to local memory in function 'input_transpose_fusion_20', 16 bytes spill stores, 16 bytes spill loads
ptxas warning : Registers are spilled to local memory in function 'input_reduce_fusion_96', 4 bytes spill stores, 4 bytes spill loads
ptxas warning : Registers are spilled to local memory in function 'input_transpose_fusion_14', 16 bytes spill stores, 16 bytes spill loads

